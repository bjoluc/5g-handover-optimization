#import "@preview/cetz:0.3.4": canvas, draw
#import "@preview/cetz-plot:0.1.1": plot


#let saMeasurements = ((1.0,115.4602),(2.0,139.0985),(3.0,160.0563),(4.0,173.2765),(5.0,183.0962),(6.0,192.4323),(7.0,199.2686),(8.0,202.7234),(9.0,207.0157),(10.0,208.6554),(11.0,210.5917),(12.0,210.7421),(13.0,211.7082),(14.0,216.2422),(15.0,216.3792),(16.0,215.8083),(17.0,216.2099),(18.0,214.07),(19.0,215.0249),(20.0,213.7783),(21.0,217.8301),(22.0,208.6734),(23.0,215.033),(24.0,220.4057),(25.0,215.659),(26.0,218.4174),(27.0,216.9303),(28.0,220.4876),(29.0,216.1379),(30.0,218.3307),(31.0,216.6918),(32.0,219.203),(33.0,218.8535),(34.0,214.1774),(35.0,218.029),(36.0,215.846),(37.0,218.7675),(38.0,214.3489),(39.0,215.74),(40.0,215.196),(41.0,214.8611),(42.0,215.4751),(43.0,214.7808),(44.0,215.4536),(45.0,215.9204),(46.0,217.2222),(47.0,216.7415),(48.0,218.8244),(49.0,222.5106),(50.0,221.5784),(51.0,220.7356),(52.0,215.773),(53.0,218.9445),(54.0,218.5629),(55.0,218.2647),(56.0,215.7604),(57.0,216.2012),(58.0,217.0071),(59.0,218.8433),(60.0,218.7282),(61.0,218.294),(62.0,218.5455),(63.0,216.7062),(64.0,217.5429),(65.0,221.9342),(66.0,222.0903),(67.0,216.8819),(68.0,218.5564),(69.0,217.2748),(70.0,217.8389),(71.0,220.0043),(72.0,221.688),(73.0,215.7296),(74.0,220.8391),(75.0,220.4354),(76.0,219.502),(77.0,222.4922),(78.0,219.6061),(79.0,217.6383),(80.0,217.6585),(81.0,217.5546),(82.0,219.0921),(83.0,217.8399),(84.0,216.5327),(85.0,220.7255),(86.0,220.4406),(87.0,217.6735),(88.0,216.2139),(89.0,221.7901),(90.0,217.8756),(91.0,220.734),(92.0,216.9126),(93.0,219.8234),(94.0,218.8092),(95.0,216.853),(96.0,218.5901),(97.0,221.8451),(98.0,221.2542),(99.0,218.0983),(100.0,223.109),(101.0,221.6858),(102.0,222.3092),(103.0,216.6897),(104.0,219.1769),(105.0,219.1609),(106.0,222.6355),(107.0,218.5112),(108.0,228.0792),(109.0,218.6181),(110.0,218.797),(111.0,218.2757),(112.0,218.0765),(113.0,217.4),(114.0,221.0156),(115.0,217.2109),(116.0,222.0538),(117.0,218.3258),(118.0,226.71),(119.0,219.9978),(120.0,221.5286),(121.0,219.2664),(122.0,222.5683),(123.0,219.5053),(124.0,219.702),(125.0,221.7847),(126.0,219.7353),(127.0,222.556),(128.0,220.9579),(129.0,218.7958),(130.0,220.8879),(131.0,223.9),(132.0,218.793),(133.0,221.9979),(134.0,222.7292),(135.0,221.3551),(136.0,220.2945),(137.0,219.3093),(138.0,227.0126),(139.0,219.2051),(140.0,219.5042),(141.0,222.7289),(142.0,222.1409),(143.0,219.0264),(144.0,222.7987),(145.0,219.2785),(146.0,220.2283),(147.0,222.9613),(148.0,220.2393),(149.0,218.4007),(150.0,222.5165),(151.0,221.8845),(152.0,218.797),(153.0,219.7635),(154.0,221.3252),(155.0,220.6075),(156.0,225.9033),(157.0,220.3652),(158.0,220.0967),(159.0,220.5957),(160.0,219.3682),(161.0,220.5992),(162.0,224.661),(163.0,222.762),(164.0,223.9676),(165.0,227.6865),(166.0,220.4186),(167.0,221.2469),(168.0,223.8528),(169.0,220.2235),(170.0,220.9102),(171.0,221.9711),(172.0,227.0624),(173.0,221.8418),(174.0,222.1197),(175.0,225.6145),(176.0,226.416),(177.0,221.5604),(178.0,223.2313),(179.0,220.6849),(180.0,224.2684),(181.0,220.635),(182.0,221.9777),(183.0,221.6874),(184.0,220.9555),(185.0,221.0867),(186.0,224.4277),(187.0,221.7121),(188.0,227.2564),(189.0,223.7858),(190.0,220.8445),(191.0,225.0081),(192.0,222.0277),(193.0,220.963),(194.0,221.4229),(195.0,222.1012),(196.0,222.2657),(197.0,225.1524),(198.0,221.3361),(199.0,224.2785))

#let nsaMeasurements = ((1.0,161.2955),(2.0,196.19),(3.0,215.3033),(4.0,229.4057),(5.0,243.3337),(6.0,249.0609),(7.0,257.789),(8.0,258.2305),(9.0,263.2225),(10.0,266.9528),(11.0,272.4142),(12.0,272.4048),(13.0,267.0578),(14.0,273.0442),(15.0,274.8418),(16.0,272.0077),(17.0,277.034),(18.0,270.8663),(19.0,274.5001),(20.0,278.9038),(21.0,276.2345),(22.0,277.2797),(23.0,280.6088),(24.0,274.7044),(25.0,285.271),(26.0,276.5425),(27.0,282.4637),(28.0,271.1415),(29.0,283.4772),(30.0,284.3716),(31.0,284.1011),(32.0,285.2079),(33.0,283.9015),(34.0,281.5871),(35.0,275.7008),(36.0,281.8427),(37.0,282.1517),(38.0,279.7531),(39.0,278.0146),(40.0,280.0758),(41.0,290.327),(42.0,282.7182),(43.0,290.0903),(44.0,280.892),(45.0,275.6984),(46.0,288.3503),(47.0,276.4474),(48.0,285.3209),(49.0,278.719),(50.0,286.9405),(51.0,282.9427),(52.0,284.6317),(53.0,284.6179),(54.0,288.8574),(55.0,288.762),(56.0,280.6628),(57.0,281.8704),(58.0,281.6302),(59.0,285.2323),(60.0,274.8338),(61.0,289.3593),(62.0,276.3872),(63.0,283.4021),(64.0,289.3407),(65.0,284.0306),(66.0,278.7357),(67.0,284.5293),(68.0,286.2108),(69.0,282.4468),(70.0,285.1754),(71.0,290.0238),(72.0,290.4884),(73.0,283.096),(74.0,284.7398),(75.0,287.7551),(76.0,285.055),(77.0,284.9243),(78.0,287.1751),(79.0,292.9625),(80.0,286.9124),(81.0,279.0075),(82.0,281.3936),(83.0,288.1269),(84.0,274.8543),(85.0,290.6992),(86.0,287.0776),(87.0,277.8592),(88.0,283.1904),(89.0,291.0435),(90.0,292.3773),(91.0,288.3314),(92.0,284.41),(93.0,282.3042),(94.0,284.5697),(95.0,288.9488),(96.0,284.9186),(97.0,285.0985),(98.0,284.1902),(99.0,285.3355),(100.0,283.4672),(101.0,284.8435),(102.0,273.02),(103.0,287.0762),(104.0,286.3433),(105.0,287.9974),(106.0,286.2121),(107.0,280.948),(108.0,288.1535),(109.0,293.2368),(110.0,287.356),(111.0,290.9585),(112.0,289.2474),(113.0,282.0015),(114.0,275.6999),(115.0,284.0286),(116.0,289.6797),(117.0,280.4293),(118.0,286.1193),(119.0,289.3708),(120.0,290.8684),(121.0,291.2509),(122.0,289.7002),(123.0,287.0592),(124.0,290.2473),(125.0,285.4183),(126.0,291.8183),(127.0,287.603),(128.0,290.4935),(129.0,280.1739),(130.0,279.058),(131.0,276.8359),(132.0,289.4246),(133.0,290.3903),(134.0,292.5214),(135.0,288.2505),(136.0,286.3231),(137.0,280.2442),(138.0,285.367),(139.0,295.1189),(140.0,283.5663),(141.0,294.2788),(142.0,286.7687),(143.0,292.2428),(144.0,282.6188),(145.0,287.1553),(146.0,293.0375),(147.0,295.9789),(148.0,289.7703),(149.0,291.297),(150.0,285.0335),(151.0,280.2801),(152.0,296.6188),(153.0,285.7622),(154.0,287.2806),(155.0,289.341),(156.0,293.8273),(157.0,289.9404),(158.0,288.1845),(159.0,284.0098),(160.0,283.2967),(161.0,286.5702),(162.0,295.4781),(163.0,289.5904),(164.0,287.1888),(165.0,290.3805),(166.0,288.7703),(167.0,292.8083),(168.0,289.4134),(169.0,282.4854),(170.0,291.6267),(171.0,282.562),(172.0,284.7549),(173.0,291.6514),(174.0,290.1679),(175.0,292.9312),(176.0,293.4208),(177.0,285.3679),(178.0,286.2255),(179.0,287.2372),(180.0,289.3571),(181.0,287.6437),(182.0,288.7146),(183.0,290.4865),(184.0,295.6506),(185.0,291.1225),(186.0,292.0046),(187.0,289.136),(188.0,290.0826),(189.0,292.4834),(190.0,282.8978),(191.0,287.0621),(192.0,283.0056),(193.0,288.3486),(194.0,289.3705),(195.0,263.7625),(196.0,283.8225),(197.0,287.9078),(198.0,290.4034),(199.0,298.2154))

#let prediction = ((0.0,7.2792),(1.0,20.8969),(2.0,31.377),(3.0,40.0551),(4.0,47.4299),(5.0,53.9715),(6.0,59.7976),(7.0,65.0692),(8.0,69.6691),(9.0,73.7317),(10.0,77.0267),(11.0,80.2588),(12.0,82.8608),(13.0,85.1009),(14.0,87.056),(15.0,88.6039),(16.0,89.9617),(17.0,91.3211),(18.0,92.2744),(19.0,93.206),(20.0,94.0081),(21.0,94.7162),(22.0,95.3444),(23.0,95.8964),(24.0,96.3306),(25.0,96.7083),(26.0,97.1557),(27.0,97.4803),(28.0,97.8177),(29.0,98.1295),(30.0,98.4216),(31.0,98.6859),(32.0,98.9396),(33.0,99.2049),(34.0,99.4429),(35.0,99.6679),(36.0,99.909),(37.0,100.136),(38.0,100.3653),(39.0,100.5815),(40.0,100.7972),(41.0,101.0232),(42.0,101.2379),(43.0,101.4532),(44.0,101.6646),(45.0,101.8769),(46.0,102.0902),(47.0,102.2995),(48.0,102.5102),(49.0,102.7218),(50.0,102.9318),(51.0,103.1411),(52.0,103.3513),(53.0,103.5612),(54.0,103.7682),(55.0,103.9784),(56.0,104.1878),(57.0,104.3967),(58.0,104.6066),(59.0,104.8157),(60.0,105.024),(61.0,105.233),(62.0,105.442),(63.0,105.6505),(64.0,105.8598),(65.0,106.0684),(66.0,106.2772),(67.0,106.4862),(68.0,106.695),(69.0,106.9037),(70.0,107.1124),(71.0,107.3212),(72.0,107.53),(73.0,107.7386),(74.0,107.9472),(75.0,108.1562),(76.0,108.365),(77.0,108.5737),(78.0,108.7825),(79.0,108.9912),(80.0,109.1999),(81.0,109.4088),(82.0,109.6175),(83.0,109.8262),(84.0,110.035),(85.0,110.2437),(86.0,110.4525),(87.0,110.6612),(88.0,110.87),(89.0,111.0788),(90.0,111.2875),(91.0,111.4962),(92.0,111.705),(93.0,111.9138),(94.0,112.1225),(95.0,112.3312),(96.0,112.54),(97.0,112.7487),(98.0,112.9575),(99.0,113.1662),(100.0,113.375),(101.0,113.5837),(102.0,113.7924),(103.0,114.0012),(104.0,114.21),(105.0,114.4188),(106.0,114.6275),(107.0,114.8362),(108.0,115.045),(109.0,115.2537),(110.0,115.4625),(111.0,115.6712),(112.0,115.88),(113.0,116.0888),(114.0,116.2975),(115.0,116.5062),(116.0,116.715),(117.0,116.9237),(118.0,117.1325),(119.0,117.3412),(120.0,117.55),(121.0,117.7587),(122.0,117.9675),(123.0,118.1762),(124.0,118.385),(125.0,118.5937),(126.0,118.8025),(127.0,119.0112),(128.0,119.22),(129.0,119.4287),(130.0,119.6375),(131.0,119.8462),(132.0,120.055),(133.0,120.2637),(134.0,120.4725),(135.0,120.6812),(136.0,120.89),(137.0,121.0987),(138.0,121.3075),(139.0,121.5162),(140.0,121.725),(141.0,121.9338),(142.0,122.1425),(143.0,122.3512),(144.0,122.56),(145.0,122.7687),(146.0,122.9775),(147.0,123.1862),(148.0,123.395),(149.0,123.6037),(150.0,123.8125),(151.0,124.0212),(152.0,124.23),(153.0,124.4387),(154.0,124.6475),(155.0,124.8562),(156.0,125.065),(157.0,125.2737),(158.0,125.4825),(159.0,125.6912),(160.0,125.9),(161.0,126.1087),(162.0,126.3175),(163.0,126.5262),(164.0,126.735),(165.0,126.9437),(166.0,127.1525),(167.0,127.3612),(168.0,127.57),(169.0,127.7787),(170.0,127.9875),(171.0,128.1962),(172.0,128.405),(173.0,128.6137),(174.0,128.8225),(175.0,129.0312),(176.0,129.24),(177.0,129.4487),(178.0,129.6575),(179.0,129.8662),(180.0,130.075),(181.0,130.2837),(182.0,130.4925),(183.0,130.7012),(184.0,130.91),(185.0,131.1187),(186.0,131.3275),(187.0,131.5362),(188.0,131.745),(189.0,131.9537),(190.0,132.1625),(191.0,132.3712),(192.0,132.58),(193.0,132.7887),(194.0,132.9975),(195.0,133.2062),(196.0,133.415),(197.0,133.6237),(198.0,133.8325),(199.0,134.0412),(200.0,134.25))

#figure(caption: [
  Comparison of Traffic Power Model Predictions with 5G SA/NSA Measurements
])[
  #canvas({
    import draw: *

    set-style(
      axes: (stroke: .5pt, tick: (stroke: .5pt)),
      legend: (stroke: .5pt, fill: rgb("#fafafa"), spacing: 0.25, item: (spacing: .25em)),
      tick: (stroke: .5pt, length: 3.2pt, minor-length: 1.8pt),
      grid: (stroke: silver + 0.7pt),
    )

    plot.plot(size: (20, 10),
      x-label: [Avg. Packets per Second],
      x-tick-step: 20,
      y-label: [Avg. UE Current [mA]],
      y-min: 0,
      y-max: 350,
      y-tick-step: 50,
      y-minor-tick-step: 10,
      x-grid: true,
      y-grid: true,
      x-min: 1,
      legend: "inner-south-east",
      {
        plot.add(
          saMeasurements,
          style: (stroke: black),
          label: "5G SA"
        )
        plot.add(
          nsaMeasurements,
          style: (stroke: (dash: "densely-dotted")),
          label: "5G NSA"
        )
        plot.add(
          prediction.map(((x, y)) => (x, y*1.55+40)),
          style: (stroke: (dash: "dashed")),
          label: "Model Prediction"
        )
      }
    )
  })
]
