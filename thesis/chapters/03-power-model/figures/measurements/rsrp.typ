#import "@preview/cetz-plot:0.1.1": plot
#import "/cetz.typ": canvas

#let measurements1 = ((-61.0,221.5569),(-58.0,241.6135),(-57.0,227.606),(-52.0,212.5366),(-54.0,210.7108),(-57.0,229.9285),(-56.0,236.8427),(-57.0,229.8376),(-57.0,233.6533),(-51.0,219.3561),(-52.0,223.4174),(-64.0,223.4137),(-51.0,217.9158),(-51.0,223.2864),(-55.0,226.2186),(-57.0,230.6197),(-52.0,221.1943),(-54.0,234.4846),(-56.0,225.0268),(-60.0,229.8952),(-60.0,232.3959),(-53.0,221.5378),(-56.0,225.9104),(-55.0,229.1454),(-57.0,245.6873),(-58.0,231.2378),(-61.0,237.4816),(-68.0,256.4631),(-71.0,258.6014),(-65.0,254.2791),(-69.0,248.3641),(-70.0,260.5762),(-65.0,228.0914),(-73.0,237.0081),(-68.0,236.6112),(-72.0,259.3231),(-70.0,256.6577),(-76.0,279.6926),(-67.0,240.9796),(-71.0,255.221),(-68.0,253.3224),(-68.0,251.3334),(-68.0,279.3854),(-70.0,262.8893),(-70.0,277.5192),(-69.0,266.671),(-67.0,263.7568),(-68.0,276.5093),(-72.0,289.9959),(-67.0,267.0046),(-64.0,263.6164),(-67.0,264.3859),(-62.0,251.8852),(-63.0,253.044),(-61.0,247.9805),(-62.0,251.9605),(-62.0,250.8864),(-64.0,257.0924),(-59.0,247.201),(-61.0,246.5948),(-66.0,237.7096),(-64.0,235.044),(-65.0,234.974),(-64.0,237.7963),(-65.0,237.4497),(-66.0,244.2881),(-63.0,245.1382),(-69.0,261.0107),(-72.0,247.1673),(-70.0,253.4108),(-69.0,242.4748),(-72.0,244.1862),(-70.0,259.478),(-69.0,234.4525),(-69.0,260.038),(-71.0,250.6357),(-74.0,261.9207),(-82.0,262.2773),(-81.0,262.2757),(-84.0,261.542),(-79.0,260.6682))

#let measurements2 = ((-51.0,220.4926),(-54.0,228.9142),(-51.0,224.2074),(-55.0,223.6603),(-55.0,224.7225),(-55.0,227.3744),(-56.0,234.4227),(-58.0,222.5532),(-54.0,221.204),(-61.0,241.3922),(-59.0,225.531),(-56.0,218.0874),(-58.0,219.4142),(-54.0,224.6023),(-52.0,226.6035),(-56.0,228.3111),(-54.0,227.1227),(-63.0,227.0311),(-59.0,240.6082),(-53.0,228.2131),(-52.0,221.4898),(-65.0,244.1355),(-55.0,236.2603),(-55.0,247.4445),(-60.0,248.4717),(-61.0,243.8178),(-61.0,253.3715),(-60.0,231.7607),(-62.0,254.3673),(-66.0,280.3519),(-65.0,252.3951),(-64.0,230.9489),(-66.0,230.8507),(-67.0,259.5594),(-69.0,237.72),(-65.0,261.9462),(-67.0,235.2329),(-73.0,236.1681),(-75.0,241.7594),(-73.0,243.9365),(-68.0,237.2385),(-71.0,291.2387),(-75.0,257.9302),(-71.0,234.8693),(-71.0,237.5564),(-72.0,252.4214),(-72.0,246.1307),(-69.0,229.8247),(-67.0,234.1376))

#figure(
  caption: [Avg. UE Power by RSRP at 100~Packets per Second],
  placement: auto,
)[
  #canvas({
    import "/cetz.typ": *

    set-style(
      axes: (stroke: .5pt, tick: (stroke: .5pt)),
      legend: (stroke: .5pt, fill: white, spacing: 0.25, item: (spacing: .25em)),
      tick: (stroke: .5pt, length: 3.2pt, minor-length: 1.8pt),
      grid: (stroke: silver + 0.7pt),
    )

    plot.plot(size: (14, 7),
      x-label: [@rsrp [dBm]],
      x-tick-step: 5,
      y-label: [Avg. @ue Current [mA]],
      y-min: 0,
      y-max: 350,
      x-min: -50,
      x-max: -85,
      y-tick-step: 50,
      y-minor-tick-step: 10,
      x-grid: true,
      legend: "inner-south-east",
      {
        plot.add(
          measurements1 + measurements2,
          style: (stroke: none),
          mark: "x",
          mark-size: .125,
          mark-style: (stroke: black),
          label: [Avg. UE Current (4~seconds, @sa)]
        )
        plot.add-hline(
          261,
          label: [Prediction \@ 23~dBm @tx Power],
          style: (
            stroke: (paint: black, dash: "dotted", thickness: 1pt)
          ),
        )
        plot.add-hline(
          215.73,
          label: [Prediction \@ 0~dBm @tx Power],
          style: (
            stroke: (paint: black, dash: "dashed", thickness: 1pt)
          ),
        )
      }
    )
  })
]<figPowerOverRsrp>

